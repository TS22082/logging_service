import{q as u,r as c,t as l,u as p,v as y,w as m,x as v,y as E,z as s,A as h}from"./constants-bC8bNLSd.js";import{i as k}from"./internalRequest-DgGd_5j3.js";const f=e=>{const t=document.createElement("tr"),n=document.createElement("td"),o=document.createElement("td"),a=document.createElement("td"),r=document.createElement("button");t.setAttribute("id","tr-"+e.id);let i=e.token.slice(-4);return i="..."+i,n.innerText=i,o.innerText=e.count.toString(),r.innerText="Delete",r.classList.add("delete__link"),r.setAttribute("data-id",e.id),r.addEventListener("click",async()=>{try{const d=document.getElementById("delete-key-popover");if(!d)return;d.setAttribute("data-id",e.id),d.showPopover()}catch(d){console.log("Error here =>",d)}}),a.appendChild(r),t.appendChild(n),t.appendChild(o),t.appendChild(a),t},g=e=>{e.addEventListener("click",()=>{const t=document.getElementById("delete-key-popover"),n=e.getAttribute("data-id");t&&n&&t.setAttribute("data-id",n),t&&t.showPopover()})};u&&u.addEventListener("submit",async e=>{e.preventDefault(),c&&(c.innerText="Loading ...");const t=document.location.href.split("/")[document.location.href.split("/").length-1];try{const n={projectId:t},{data:o}=await k.Post("/api/key",n);console.log("Data ==>",o);const a=f(o);l&&l.showModal(),p&&(p.innerText=o.token),y&&y.appendChild(a)}catch(n){console.log("Error ==>",n)}finally{c&&(c.innerText="Create API Key")}});m&&m.forEach(e=>g(e));v&&v.addEventListener("click",()=>{const e=document.getElementById("delete-key-popover");e&&e.hidePopover()});E&&E.addEventListener("click",async function(){if(!s)return;const e=s.getAttribute("data-id"),t=document.getElementById("tr-"+e);if(t)try{const n=`/api/key/${e}`;if((await k.Delete(n)).success)t.remove(),s.removeAttribute("data-id"),s.hidePopover();else throw new Error("Error in response")}catch(n){console.log("Error ==>",n)}});h&&h.addEventListener("click",()=>{l.close()});
